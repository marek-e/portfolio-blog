---
import Layout from '@/layouts/Layout.astro';
import CV from '@/components/astro/CV.astro';
import { getTranslations, defaultLang } from '@/i18n';
import { HugeiconsIcon } from '@hugeicons/react';
import { PrinterIcon } from '@hugeicons/core-free-icons';
import Navbar from '@/components/astro/Navbar.astro';
import Footer from '@/components/astro/Footer.astro';

export function getStaticPaths() {
  return [
    { params: { lang: undefined } }, // / → French (default)
    { params: { lang: 'en' } as const }, // /en/ → English
  ];
}

const lang = Astro.params.lang ?? defaultLang;
const t = getTranslations(lang);
---

<Layout title={t.cv.pageTitle} description={t.cv.pageDescription}>
  <script
    is:inline
    slot="head"
    type="application/ld+json"
    set:html={JSON.stringify({
      '@context': 'https://schema.org',
      '@type': 'ProfilePage',
      name: 'CV - Marek Elmayan',
      url: 'https://melmayan.fr/curriculum-vitae',
      description: 'Curriculum Vitae de Marek Elmayan, ingénieur logiciel full-stack.',
      mainEntity: {
        '@type': 'Person',
        name: 'Marek Elmayan',
        jobTitle: 'Full-Stack Software Engineer',
        url: 'https://melmayan.fr',
        email: 'melmayan.dev@gmail.com',
      },
    })}
  />
  <Navbar />
  <main class="bg-background mt-24 min-h-dvh py-8">
    <div class="container mx-auto px-4">
      <div class="no-print mb-4 flex justify-end">
        <button
          onclick="window.print()"
          class="bg-primary text-primary-foreground hover:bg-primary/90 inline-flex cursor-pointer items-center gap-2 rounded-lg px-4 py-2 text-sm font-medium transition-colors"
          aria-label={t.cv.downloadPdf}
        >
          <HugeiconsIcon icon={PrinterIcon} className="size-4" />
          {t.cv.downloadPdf}
        </button>
      </div>
      <CV lang={lang} />
    </div>
  </main>
  <Footer />
</Layout>
